\documentclass[12pt]{article}
\usepackage[]{graphicx}
\usepackage[]{color}
%% use \xspace to allow for space after a macro as necessary
\usepackage{xspace}
\usepackage[top=1in, bottom=1in, left=1.25in, right=1.25in]{geometry}
\usepackage{pdfpages}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{commentcol}{rgb}{0.345, 0.345, 0.945}
\newcommand{\comment}[1]{\textcolor{commentcol}{[[#1]]}}%

% general-purpose mathrm macros
\newcommand{\symsub}[2]{\ensuremath{#1_{\tiny \mathrm{#2}}}\xspace}
\newcommand{\mrm}[1]{\ensuremath{\mathrm{#1}}
\xspace}

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{randomcolor}{rgb}{.97, .27, .67}
\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage[sort]{natbib}
\usepackage{amsmath}
\usepackage{alltt}
\usepackage{hyperref}
\usepackage[utf8]{inputenc} % for accented characters
%% stuff for editing
%\usepackage[markup=nocolor,addedmarkup=bf,deletedmarkup=sout]{changes}
%% to suppress notes & comments: \usepackage[final]{changes}
\usepackage[backgroundcolor=lightgray]{todonotes}
\usepackage{setspace}
\bibliographystyle{chicago}
\title{Need a good title.}
\author{Michael Li and Ben Bolker}
\date{\today}

\providecommand{\keywords}[1]{\textbf{\textit{Keywords:}} #1}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
\newcommand{\dbic}{\ensuremath \Delta \textrm{BIC}}

%% don't typeset BMB comments
\newcommand{\bmbhide}[1]{}
\newcommand{\bmb}[1]{{\color{blue} BB: #1}}

\newcommand{\fref}[1]{Figure~\ref{fig:#1}}

\newcommand{\ml}[1]{{\color{red} ML: #1}}

\newcommand{\add}[1]{{\color{blue} ADD: #1}}

%\SweaveOpts{concordance=TRUE}
%\SweaveOpts{concordance=TRUE}
\maketitle

\doublespacing

\keywords{phyloglmm ... }

\section{Introduction}
\ml{I will fill in appropriate citation later}


Given a phylogenetic tree, phylogenetic models aim to find parsimonious methods that can be used to link ecological phenomena with evolutionary processes that generate species and exhibit in their traits.
Ecologist have long considered the effects of species functional traits and environmental conditions on their phenotypic traits and also incorportating historical relationships of species.
Decades of work have created various different methods that enables researchers to analyze species relativeness problems/systems for different types of data and questions.
But many challenges remain.
In particular, incorportating phylogenetic signals in complex/large/multi dimensional systems is always challenging, especially with large phylogenies where computation powers are limited.
In such case, researchers often use simpler models with minimal phylogenetic signals limiting at the species/individuals level and neglect additional phylogenetic signals present in the system/model.

%For example, regression analyses of body temperature as a function of body size for animal within a clade, species compositions in different sites, etc. 
The most widely used statistical method to model/fit related species data that accounts for phylogenetic structure is the phylogenetic regression (Felsenstein 1985).
The typical phylogenetic regression is of the form:
\begin{align}
y & = XB + \epsilon \\
\epsilon & \sim MVN(0,\sigma^{2}C),
\end{align}
where $y$ is an $n \times 1$ vector of measureable response phenotypic trait; $X$ is an $n \times (m + 1)$ model matrix containing 1's in the first column and the $m$ independment variable (traits); $B$ is an $m \times 1$ coefficient vector; $\espilon$ is the residual error and assumed to be multivariate normally distributed with a variance-covariance matrix given by $\sigma^{2}_{ \epsilon} C$ in which $C$ is the phylogenetic correlation (PC).
\ml{Need to say something like $\epsilon$ explains all the phylogenetic corelation and error or zero residual}

More recently, researchers use linear mixed model and generalized linear mixed model framework to model complex systems with phylogenetic structures.
\ml{Why? Data type, interactions, random effects, etc... Need to really explain random effects here. Alternatively, we can drop this line and write this...}
An alternative modelling approach is to use linear mixed effects modelling framework.
The typical phylogenetic linear mixed model has the form:
\begin{align}
Y & \sim N(XB + Zb, \sigma^{2}),
\end{align}
Despite the choice of modeling strageties, there isn't a convient platform to do all and limited in model complexities additional complexities in the systems and . 
\ml{This sounds cheesy}

In this paper, we took a simple, yet effective alternative approach model to model phylogenetic correlation where we ... . We used lme4 and test it with simulated cases and fit it to dun (maybe more examples if we can find it) example. 
We will compare our simulations and example fits to different platforms. 

\section{Materials and Methods}

We generate test data using a simple glmm framework that varies in complexity in random effect. All simulations and fits were performed with R. 

\subsection{Simulations}

%We simulated two phenotypic traits (X andY). 
The typical phylogenetic linear mixed model analysis is of the form:

\begin{align}
(Y \mid B=b) & \sim N(X\beta + Zb, \sigma^{2}),
\end{align}
where the conditional distribution of Y given $ B = b$ is a $n \times 1$ vector random response variable, whose observed value is y of some measureable phenotypic trait; 
X is an $n \times (m + 1)$ model matrix containing 1's in the first column and the $m$ independent variables (traits);
Z is an $n \times (m + 1)$ model matrix for the $m + 1$ -- dimensional vector-valued random effects variable; 
$\beta$ is a $ m + 1 $ coefficient vector.
The parameters of the model are the coefficients $\beta$ and the scale parameter $\sigma$.
The unconditional distribution of B is multivariate normal with mean zero and a parameterized $(m + 1) \times (m + 1)$ variance-covariance matrix
\begin{align}
B & \sim \mathrm{MVN}(0,\Sigma),
\end{align}
and
\begin{align}
\Sigma & = \begin{pmatrix} \sigma^2_{sp} & \rho \sigma_{sp} \sigma_{X} \\ \rho \sigma_{sp} \sigma_{X} & \sigma^2_{X} \end{pmatrix},
\end{align}
where $\sigma^{2}_{sp}$ and $\sigma^{2}_{X}$ is the phylogenetic variance of species and phenotype X; 
and $\rho$ is the correlation of \ml{...?}.


\subsection{Phylogenetic Tree Transformation}
The standard problem of phylogenetic comparative methods is to analyze relationships among data where the observations are gathered from nodes (usually tips) of a phylogenetic tree. 

An alternative approach is to model the phylogenetic correlation as a gaussian process. 
In particular, suppose that the evolutionary process is a Brownian motion. 
In that case, the phylogenetic variability of a particular observation can be written as the sum of the evolutionary changes that occurred on all of the branches in the phylogeny in its past. 
If we set up the Z matrix appropriately, we can model everythign with a sequence of independent errors, rather than having to do a fancy things to impose a correlation structure on the random effects. 

\subsection{Model Fitting}
\ml{platform/model equivalence}

...


\section{Results}

\section{Discussion}

\section{Conclusion}

\end{document}

